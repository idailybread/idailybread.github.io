<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="http://www.gov.cn/" title="乐信圣文" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="动画是多媒体中的一个重要组成部分，我们常见的各种炫酷的特效大部分都是通过动画来实现的。 　　在Android3.0之前，我们有两种实现动画效果的方式：帧动画 和 视图动画。 -  帧动画(Frame Animation)通过短时间内连续播放多张图片来实现动画效果，和电影类似。 -  视图动画(View Animation)通过让View对象执行平移、缩放、旋转、透明四种操作，来达到动画效果。">
<meta property="og:type" content="article">
<meta property="og:title" content="媒体篇　第三章 动画">
<meta property="og:url" content="http://yoursite.com/android-D03/index.html">
<meta property="og:site_name" content="乐信圣文">
<meta property="og:description" content="动画是多媒体中的一个重要组成部分，我们常见的各种炫酷的特效大部分都是通过动画来实现的。 　　在Android3.0之前，我们有两种实现动画效果的方式：帧动画 和 视图动画。 -  帧动画(Frame Animation)通过短时间内连续播放多张图片来实现动画效果，和电影类似。 -  视图动画(View Animation)通过让View对象执行平移、缩放、旋转、透明四种操作，来达到动画效果。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/img/android/android_4_6.png">
<meta property="og:image" content="http://yoursite.com/img/android/android_d03_01.png">
<meta property="og:image" content="http://img.blog.csdn.net/20150504225258841">
<meta property="og:updated_time" content="2018-09-09T10:47:48.468Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="媒体篇　第三章 动画">
<meta name="twitter:description" content="动画是多媒体中的一个重要组成部分，我们常见的各种炫酷的特效大部分都是通过动画来实现的。 　　在Android3.0之前，我们有两种实现动画效果的方式：帧动画 和 视图动画。 -  帧动画(Frame Animation)通过短时间内连续播放多张图片来实现动画效果，和电影类似。 -  视图动画(View Animation)通过让View对象执行平移、缩放、旋转、透明四种操作，来达到动画效果。">
<meta name="twitter:image" content="http://yoursite.com/img/android/android_4_6.png">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/android-D03/"/>

  <title> 媒体篇　第三章 动画 | 乐信圣文 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?53b4b0b5aeb5df5e4fb6263a58d8e1a9";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">乐信圣文</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-feedback">
          <a href="/feedback" rel="section">
            
            留言
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                媒体篇　第三章 动画
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-05-15T12:29:42+08:00" content="2015-05-15">
              2015-05-15
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Android开发-倔强青铜/" itemprop="url" rel="index">
                    <span itemprop="name">Android开发 - 倔强青铜</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/android-D03/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="android-D03/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/android-D03/" class="leancloud_visitors" data-flag-title="媒体篇　第三章 动画">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>　　动画是多媒体中的一个重要组成部分，我们常见的各种炫酷的特效大部分都是通过动画来实现的。</p>
<p><br>　　在<code>Android3.0</code>之前，我们有两种实现动画效果的方式：帧动画 和 视图动画。</p>
<pre><code>-  帧动画(Frame Animation)通过短时间内连续播放多张图片来实现动画效果，和电影类似。
-  视图动画(View Animation)通过让View对象执行平移、缩放、旋转、透明四种操作，来达到动画效果。
</code></pre><p>　　从<code>Android 3.0</code>开始，系统推出了属性动画(<code>property animation</code>)，它的功能非常强大，弥补了之前视图动画的一些缺陷，几乎是可以完全替代掉视图动画了。</p>
<p><br><strong>视图动画的缺点</strong></p>
<pre><code>-  第一，视图动画提供的功能只能作用在View对象上，所以如果你想动画非View对象，你要自己来实现。 
-  第二，视图动画系统只能动画View对象几个方面，如缩放、平移等。它没法把View的背景颜色、字体颜色、margin、padding等属性进行动态变化。
-  第三，视图动画不是会修改View本身。虽然你的动画在屏幕上移动一个按钮后，从屏幕上来看按钮确实被移动到了新的位置，但按钮实际的位置不会改变，所以你要实现自己的逻辑来处理这个问题。
</code></pre><p><br>　　视图动画的缺点在属性动画中完全被消除了，你可以动画任何对象的任何属性（视图和非视图），并且对象本身实际（尺寸、位置等）也是会被修改。属性动画的缺点是：在<code>Android3.0</code>中才被提出。<br>　　即便如此，现在也算是到了学习属性动画的时候了，截止至<code>2015/05/25</code>，配置<code>Android3.0</code>以下版本系统的设备已经不足<code>6%</code>了，换句话说我们现在完全可以把项目的<code>minSdkVersion</code>设置为<code>11</code>了。<br>　　当然在<code>Android3.0</code>之前版本的系统中我们也是可以使用属性动画的，这一点在第四节将详细介绍，第三节将以<code>Android3.0</code>版本来讲解属性动画。</p>
<p><br><strong>使用视图动画还是属性动画？</strong><br>　　在某些时候，使用视图动画可以花费更少的时间，更少的代码，因此如果视图动画完成了你需要做的，或者你现有的代码已经完成了工作，那就没有必要使用属性动画系统。</p>
<h1 id="第一节-视图动画"><a href="#第一节-视图动画" class="headerlink" title="第一节 视图动画"></a>第一节 视图动画</h1><p>　　虽然视图动画已经不常用了，但是我们仍然要介绍一下它们的用法。</p>
<p>　　在Android中实现视图动画的方式有两种：</p>
<pre><code>-  通过XML文件：在res/anim文件夹下面建立动画文件，每个动画文件对应一个xml文件。
-  通过编写代码：直接在代码中new出一个动画对象。
</code></pre><p><br>　　Android提供了四种视图动画：<code>透明</code>、<code>平移</code>、<code>旋转</code>、<code>缩放</code>。</p>
<p><br><strong>透明</strong><br>　　透明(<code>alpha</code>)动画 ，可以将一个<code>View</code>从某个透明度转变为另一个透明度。</p>
<p><br>　　范例1：透明动画(<code>alpha.xml</code>)。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">alpha</span> </span></span><br><span class="line"><span class="tag">      	<span class="attr">android:fromAlpha</span>=<span class="string">"1.0"</span></span></span><br><span class="line"><span class="tag">     	<span class="attr">android:toAlpha</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">     	<span class="attr">android:duration</span>=<span class="string">"5000"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  本范例通过XML文件来定义一个透明动画，必须要将动画文件放到res/anim文件夹下。
-  使用&lt;alpha&gt;标签来定义一个透明动画。

属性解释：
-  android:fromAlpha     控件的初始透明度。取值在0.0~1.0之间。1.0为完全不透明。
-  android:toAlpha       动画结束时，控件的透明度。
-  android:duration      播放动画时持续的时间。 
</code></pre><p><br>　　范例2：播放动画。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AndroidTestActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ImageView img;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.main);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">this</span>.img = (ImageView) <span class="keyword">this</span>.findViewById(R.id.img);</span><br><span class="line">        <span class="comment">// 指定动画文件的资源ID ，将其从res/anim目录导入到程序中，并将其转换为一个Animation对象。</span></span><br><span class="line">        Animation animation = AnimationUtils.loadAnimation(<span class="keyword">this</span>, R.anim.alpha);</span><br><span class="line">        <span class="keyword">this</span>.img.startAnimation(animation);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  本范例是在ImageView上面播放刚才我们创建的透明动画。
</code></pre><p><br>　　范例3：通过代码实现动画。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AndroidTestActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ImageView img; </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.main);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">this</span>.img = (ImageView) <span class="keyword">this</span>.findViewById(R.id.img);</span><br><span class="line">        <span class="comment">// 直接实例化一个AlphaAnimation对象，构造方法为：AlphaAnimation (float fromAlpha,float toAlpha)。</span></span><br><span class="line">        Animation animation = <span class="keyword">new</span> AlphaAnimation(<span class="number">1.0f</span>,<span class="number">0.1f</span>);</span><br><span class="line">        <span class="comment">// 设置动画的播放时间，单位(毫秒)。</span></span><br><span class="line">        animation.setDuration(<span class="number">4000</span>);</span><br><span class="line">        <span class="comment">// 设置控件是否定格在动画播放完成后的状态。</span></span><br><span class="line">        animation.setFillAfter(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">this</span>.img.startAnimation(animation);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  本范例是在ImageView上面播放刚才我们创建的透明动画。
</code></pre><p><br><strong>平移</strong><br>　　平移(<code>translate</code>)动画，可以将指定的View从某一个位置移动到另一个位置。某个View的平移动画的播放范围是其父控件所占的空间。如下图所示： </p>
<center><br><img src="/img/android/android_4_6.png" alt=""><br></center>

<p>　　上图中<code>灰色部分</code>是一个线性布局，布局内有<code>TextView</code>和<code>Button</code>两个控件 。若此时<code>按钮B</code>需要播放一个平移动画，那么<code>按钮B</code>的平移动画的<code>可视范围</code>则是线性布局所占据的区域，即上图中的灰色部分。 </p>
<p><br>　　范例1：平移动画(<code>alpha.xml</code>)。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">translate</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromXDelta</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromYDelta</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toXDelta</span>=<span class="string">"100"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toYDelta</span>=<span class="string">"150"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"3000"</span>	/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<pre><code>属性解释：
-  android:fromXDelta    设置动画移动时的起始X坐标。
-  android:fromYDelta    设置动画移动时的起始Y坐标。
-  android:toXDelta      设置动画移动时的结束X坐标。
-  android:toYDelta      设置动画移动时的结束Y坐标。 
</code></pre><p><br>　　对于平移动画的四个属性来说，其值可以使用百分比或具体数字来表示：</p>
<pre><code>-  若取值为百分比：则表示当前控件内部的某个位置。如“50%”。
-  若取值为百分比p：则表示当前控件的父控件内部的某个位置。如“50%p”。
-  若取值为具体常量：常量就是相对于当前控件的在未播放动画时的左上角坐标的偏移量。
</code></pre><p>　　因此，在范例1中，动画的起点就是按钮B的左上角，动画的终点就是左上角坐标沿着<code>x</code>轴偏移<code>100</code>像素，沿着<code>y</code>轴偏移<code>150</code>像素。 </p>
<p><br><strong>旋转</strong><br>　　旋转(<code>rotate</code>)动画，可以将指定的View沿着某一个点从某一个角度旋转到另一个角度。旋转动画的可视范围同样是待播放动画的View的父控件所占据的空间。</p>
<p><br>　　范例1：旋转动画。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">rotate</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromDegrees</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toDegrees</span>=<span class="string">"-90"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:pivotX</span>=<span class="string">"50%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:pivotY</span>=<span class="string">"50%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"3000"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<pre><code>属性解释：
-  android:fromDegrees       设置控件(相对于0度)最初旋转角度。若值为0则控件不旋转。
-  android:toDegrees         设置控件(相对于0度)最终旋转角度，若值与fromDegrees相等则控件不旋转。
-  android:pivotX和pivotY    设置控件旋转时所用的参照点的X和Y轴坐标。

若将fromDegrees或toDegrees属性的值设置为负数，则动画会按照逆时针旋转。
</code></pre><p><br>　　范例2：<code>RotateAnimation</code>类。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根据指定的参数构造一个RotateAnimation对象。 </span></span><br><span class="line"><span class="comment">// 此构造方法默认是相对于屏幕上的某个点进行旋转。若想相对于控件本身或父元素旋转，则需要调用另一个构造方法。</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">RotateAnimation</span><span class="params">(<span class="keyword">float</span> fromDegrees, <span class="keyword">float</span> toDegrees, <span class="keyword">float</span> pivotX, <span class="keyword">float</span> pivotY)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// 根据指定的参数构造一个RotateAnimation对象。</span></span></span><br><span class="line"><span class="function"><span class="comment">// 其中pivotXType和pivotYType指出当前动画旋转的参照点的类型，有三个取值：</span></span></span><br><span class="line"><span class="function"><span class="comment">// -  相对的(RELATIVE)：</span></span></span><br><span class="line"><span class="function"><span class="comment">//    -  Animation.RELATIVE_TO_SELF ：控件围绕自己内部的某点旋转。</span></span></span><br><span class="line"><span class="function"><span class="comment">//    -  Animation.RELATIVE_TO_PARENT ：控件围绕其父组件内部某点旋转。</span></span></span><br><span class="line"><span class="function"><span class="comment">// -  绝对的(ABSOLUTE)：</span></span></span><br><span class="line"><span class="function"><span class="comment">//    -  Animation.ABSOLUTE：控件围绕屏幕中的某个具体的点旋转。</span></span></span><br><span class="line"><span class="function"><span class="comment">// -  其中pivotXValue和pivotYValue的取值范围为：</span></span></span><br><span class="line"><span class="function"><span class="comment">// -  若Type设置为相对的(RELATIVE)，则取值范围是0.0~1.0之间。1.0就是100%。</span></span></span><br><span class="line"><span class="function"><span class="comment">// -  若Type设置为绝对的(ABSOLUTE) ，则取值可以是一个具体的数字。</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">RotateAnimation</span><span class="params">(<span class="keyword">float</span> fromDegrees, <span class="keyword">float</span> toDegrees, <span class="keyword">int</span> pivotXType, <span class="keyword">float</span> pivotXValue, <span class="keyword">int</span> pivotYType, <span class="keyword">float</span> pivotYValue)</span></span></span><br></pre></td></tr></table></figure></p>
<p><br><strong>缩放</strong><br>　　缩放(<code>scale</code>)动画，可以将指定的View沿着某一个点从某一个尺寸缩放到另一个尺寸。缩放动画的可视范围同样是待播放动画的View的父控件所占据的空间。</p>
<p><br>　　范例1：缩放动画。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scale</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromXScale</span>=<span class="string">"1.0"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromYScale</span>=<span class="string">"5.0"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toXScale</span>=<span class="string">"3.0"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:toYScale</span>=<span class="string">"1.0"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:pivotX</span>=<span class="string">"50%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:pivotY</span>=<span class="string">"50%"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"5000"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<pre><code>属性解释：
-  android:fromXScale    设置控件最初在水平方向上被缩放的倍数。若为1.0则不缩放。
-  android:fromYScale    设置控件最初在垂直方向上被缩放的倍数。若为1.0则不缩放。
-  android:toXScale      设置控件最终在水平方向上被缩放的倍数。
-  android:toYScale      设置控件最终在垂直方向上被缩放的倍数。
-  android:pivotX        设置控件以某个中心点进行缩放时，中心点的X坐标。 
-  android:pivotY        设置控件以某个中心点进行缩放时，中心点的Y坐标。
</code></pre><p><br>　　范例2：反向。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">scale</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fromXScale</span>=<span class="string">"1"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fromYScale</span>=<span class="string">"1"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:toXScale</span>=<span class="string">"-1"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:toYScale</span>=<span class="string">"-1"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:pivotX</span>=<span class="string">"50%"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:pivotY</span>=<span class="string">"50%"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:duration</span>=<span class="string">"3000"</span> /&gt;</span></span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  若fromXScale、fromYScale、toXScale、toYScale四个属性的取值为负数，则：
   -  X轴会以中心点X轴坐标为准从右到左的反向。
   -  Y轴会以中心点Y轴坐标为准从上到下的反向。
</code></pre><p><br><strong>AnimationSet</strong><br>　　使用<code>&lt;set&gt;</code>标签来定义一个动画集合，其内部可以嵌套其他动画，甚至是另一个<code>&lt;set&gt;</code>，<code>&lt;set&gt;</code>使用<code>AnimationSet</code>类来表示。</p>
<p>　　范例1：一组动画。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">alpha</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"1000"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromAlpha</span>=<span class="string">"0.5"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toAlpha</span>=<span class="string">"1.0"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scale</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"1000"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromXScale</span>=<span class="string">"1"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromYScale</span>=<span class="string">"1"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toXScale</span>=<span class="string">"0.5"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toYScale</span>=<span class="string">"0.5"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">translate</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"1000"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromXDelta</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromYDelta</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toXDelta</span>=<span class="string">"150"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:startOffset</span>=<span class="string">"3000"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toYDelta</span>=<span class="string">"150"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  使用动画的android:startOffset属性可以设置其播放的开始时间，单位是毫秒。
-  本范例中，当这个动画集合开始时会首先播放前两个动画，等动画集已经播放了三秒时，第三个平移动画才开始播放。
</code></pre><p>　　<code>&lt;set&gt;</code>标签支持如下两个属性：</p>
<pre><code>-  interpolator：表示AnimationSet所采用的插值器，插值器影响动画的速度。
  -  默认取值为@android:anim/accelerate_decelerate_interpolator。 
-  shareInterpolator：表示AnimationSet中的动画是否和集合共享一个插值器。
</code></pre><p><br><strong>Interpolators</strong><br>　　<code>Interpolators</code>是动画插值器，它可以影响动画的播放速度，可以对动画进行<code>加速</code>、<code>减速</code>、<code>重复</code>、<code>反弹</code>等。<br>　　所有的插值器都是<code>Interpolators</code>类的子类，现有的插值器如下表所示：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">加速器类名				资源id</span><br><span class="line">AccelerateDecelerateInterpolator	<span class="meta">@android</span>:anim/accelerate_decelerate_interpolator</span><br><span class="line">AccelerateInterpolator			<span class="meta">@android</span>:anim/accelerate_interpolator</span><br><span class="line">AnticipateInterpolator			<span class="meta">@android</span>:anim/anticipate_interpolator</span><br><span class="line">AnticipateOvershootInterpolator		<span class="meta">@android</span>:anim/anticipate_overshoot_interpolator</span><br><span class="line">BounceInterpolator			<span class="meta">@android</span>:anim/bounce_interpolator</span><br><span class="line">CycleInterpolator			<span class="meta">@android</span>:anim/cycle_interpolator</span><br><span class="line">DecelerateInterpolator			<span class="meta">@android</span>:anim/decelerate_interpolator</span><br><span class="line">LinearInterpolator			<span class="meta">@android</span>:anim/linear_interpolator</span><br><span class="line">OvershootInterpolator			<span class="meta">@android</span>:anim/overshoot_interpolator</span><br></pre></td></tr></table></figure></p>
<p>　　使用的方法：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">android:interpolator</span>=<span class="string">"@android:anim/accelerate_interpolator"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  interpolator属性的值必须指向加速器的资源Id，而不是类名。
-  &lt;set&gt;标签的子标签也可以使用interpolator属性来指定自己的插值器。
</code></pre><p>　　插值器一个常见的应用场景是：</p>
<pre><code>播放旋转动画时，如果不为其指定插值器，则系统会默认使用AccelerateDecelerateInterpolator，此插值器的特点是，在动画开始时候加速，在动画结束的时候减速。
如果我们想循环播放这个旋转动画的话，就会给人一种不连贯的感觉，此时就可以使用LinearInterpolator了，它会线性匀速的播放动画。
</code></pre><p>　　关于插值器，在属性动画一节会有详细的介绍，不明白的兄弟可以暂时存疑。</p>
<p><br><strong>事件监听</strong><br>　　通过<code>Animation</code>的<code>setAnimationListener</code>方法可以给视图动画添加监听器，接口如下所示：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">interface</span> <span class="title">AnimationListener</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 动画开始播放时调用</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onAnimationStart</span><span class="params">(Animation animation)</span></span>;</span><br><span class="line">    <span class="comment">// 动画播放结束时调用</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onAnimationEnd</span><span class="params">(Animation animation)</span></span>;</span><br><span class="line">    <span class="comment">// 动画重复播放时调用</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onAnimationRepeat</span><span class="params">(Animation animation)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><br><strong>出场动画</strong><br>　　在<code>ViewGroup</code>类中定义了<code>android:layoutAnimation</code>属性，用于给其子元素设置出场动画。</p>
<p>　　首先要创建一个布局动画文件：</p>
<p>　　范例1：<code>res/anim/anim_layout.xml</code>。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">layoutAnimation</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:delay</span>=<span class="string">"5"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:animationOrder</span>=<span class="string">"normal"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:animation</span>=<span class="string">"@anim/fade_in"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">layoutAnimation</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  delay属性：表示子元素开始动画的时间延迟。
   -  比如动画的持续时间是1秒，那么delay=5就表示除了第一个子元素之外的每一个子元素都要依次延迟5秒才开始播放。
   -  也就是说，第一个子元素会立刻显示出来，第二个延迟5秒，第三个会延迟10秒，依次类推。
   -  delay的值也可以是小数，比如0.5就表示延迟时间为动画播放时间的一半。
-  animationOrder属性：表示子元素播放动画的顺序。取值有三个：
   -  normal：顺序显示，即从第一个子元素开始播放入场动画。
   -  reverse：倒叙显示，即从最后一个子元素开始播放入场动画。
   -  random：随机播放入场动画。
-  animation属性：每个子元素所要播放的动画。
</code></pre><p><br>　　然后创建每个子元素所要播放的动画：</p>
<p>　　范例2：<code>res/anim/fade_in.xml</code>。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">alpha</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:duration</span>=<span class="string">"1000"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fromAlpha</span>=<span class="string">"0.0"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:interpolator</span>=<span class="string">"@android:anim/decelerate_interpolator"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:toAlpha</span>=<span class="string">"1.0"</span> /&gt;</span></span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  渐入动画，在1秒内让View从完全看不见到完全看的见。
</code></pre><p><br>　　最后将布局动画设置到<code>ViewGroup</code>上：</p>
<p>　　范例3：为控件设置动画。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layoutAnimation</span>=<span class="string">"@anim/anim_layout"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"AAAAAAAAAAAAAAA"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">"20sp"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"BBBBBBBBBBBBBBB"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">"20sp"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"CCCCCCCCCCCCCCC"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">"20sp"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  任何ViewGroup的子类都可以使用android:layoutAnimation属性，通常用在ListView上。
</code></pre><p><br>　　提示：<code>android:layoutAnimation</code>属性是<code>API Level 1</code>中提供的，可以放心使用。</p>
<h1 id="第二节-帧动画"><a href="#第二节-帧动画" class="headerlink" title="第二节 帧动画"></a>第二节 帧动画</h1><p>　　帧动画通过在短时间内连续播放多张图片来达到动画的效果。</p>
<p><br>　　范例1：建立动画文件<code>res/drawable/look.xml</code>。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">animation-list</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span> <span class="attr">android:oneshot</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">"@drawable/girl_1"</span> <span class="attr">android:duration</span>=<span class="string">"120"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">"@drawable/girl_2"</span> <span class="attr">android:duration</span>=<span class="string">"120"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">"@drawable/girl_3"</span> <span class="attr">android:duration</span>=<span class="string">"120"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">"@drawable/girl_4"</span> <span class="attr">android:duration</span>=<span class="string">"120"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">animation-list</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  帧动画的根标签为&lt;animation-list&gt;，帧动画的xml文件必须要放在res/drawable文件夹中。
-  &lt;item&gt;标签描述帧动画中的每一帧所要显示的图片。

属性解释
-  android:oneshot   设置动画是否只播放一次。若值为false，则动画会循环播放。
-  &lt;item&gt;标签的 android:drawable 当前帧所显示的图片。
-  &lt;item&gt;标签的 android:duration 当前帧的持续时间（毫秒）。
</code></pre><p><br>　　范例2：使用动画。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:src</span>=<span class="string">"@drawable/look"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:onClick</span>=<span class="string">"onClick"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/img"</span> /&gt;</span></span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  使用&lt;ImageView&gt;的android:src属性来指向新建立好的动画文件look.xml。
</code></pre><p><br>　　范例3：播放动画。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AnimationDrawable drawable = (AnimationDrawable) <span class="keyword">this</span>.img.getDrawable();</span><br><span class="line">drawable.start();</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  调用ImageView的getDrawable方法获取动画后，就可以启动动画了。
-  提示：帧动画不可以通过AnimationUtils工具类获取，该类仅能获取视图动画。
</code></pre><p><br>　　在<code>Activity</code>的<code>onCreate()</code>中调用<code>AnimationDrawable</code>的<code>start()</code>方法动画并不会被播放。<br>　　这是因为<code>AnimationDrawable</code>不能在不完全的窗口上运行，解决方法是在<code>onCreate()</code>方法之后的<code>onWindowFocusChanged()</code>方法中启动动画。</p>
<p><br>　　范例4：在<code>onWindowFocusChanged</code>中。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onWindowFocusChanged</span><span class="params">(<span class="keyword">boolean</span> hasFocus)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onWindowFocusChanged(hasFocus);</span><br><span class="line">    <span class="keyword">if</span>(hasFocus)&#123; <span class="comment">// 若当前Activity获得焦点。</span></span><br><span class="line">        TextView text = (TextView) findViewById(R.id.text);</span><br><span class="line">        AnimationDrawable drawable =(AnimationDrawable) text.getBackground();</span><br><span class="line">        drawable.start();    		</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  onWindowFocusChanged方法将在Activity的onResume方法之后且用户可操作之前被调用。
</code></pre><h1 id="第三节-属性动画"><a href="#第三节-属性动画" class="headerlink" title="第三节 属性动画"></a>第三节 属性动画</h1><p>　　在介绍属性动画之前，笔者要先统一下“动画”的概念：</p>
<pre><code>-  如果笔者说“让一个Button在3秒内放大两倍，其实就是在让它播放一个动画”，相信大家都不会有什么异议。
-  那么仔细想一下，动画的本质其实就是，“让一个物体在指定时间内，从一个状态转变为另一个状态”。
-  进而可以得出：“让一个int变量的值在3秒内从0过度到100，其实也就是让int变量播放一个动画”。
</code></pre><p>　　前面介绍的视图动画只支持四种（<code>缩放</code>、<code>平移</code>、<code>选择</code>、<code>透明</code>）操作，而且只能动画<code>View</code>对象。而接下来要介绍的属性动画可以对任何对象做动画，就像上面说的动画一个<code>int</code>变量。</p>
<p>　　此时你可能会有疑问，何时会需要动画一个<code>int</code>值呢？</p>
<pre><code>-  在后面的章节中会介绍到，View类提供了scrollTo和scrollBy两个方法，用来滚动View的内容。
-  比如说，如果屏幕高800，但是View的高度为1400，那它的内容就没法一屏显示出来，只能通过滚动才能看到后面的内容。
-  但是scrollTo和scrollBy两个方有个缺点，它们被调用时会立刻将View的内容滚动到目标位置，也就是说没有滑翔过程，会给人很生硬的感觉。
-  此时如果我们把滚动条的当前位置定义为i，那么就可以使用属性动画来动画这个i了，即让i在1秒内从当前位置变为目标位置。
-  然后我们只需要在动画的过程中（可以给动画设置回调）不断的调用scrollTo或scrollBy即可。
</code></pre><p>　　如果不理解上面举的这个例子也没关系，你只需要知道：“动画一个<code>int</code>变量是很常见的一个操作”就行了。事实上，视图动画可以实现的功能，属性动画都可以实现。</p>
<p><br>　　笔者在此声明，本节主要参考阅读下面三篇文章（有修改）：</p>
<ul>
<li><a href="http://blog.csdn.net/guolin_blog/article/details/43536355#" target="_blank" rel="noopener">Android属性动画完全解析(上)，初识属性动画的基本用法</a></li>
<li><a href="http://blog.csdn.net/guolin_blog/article/details/43816093" target="_blank" rel="noopener">Android属性动画完全解析(中)，ValueAnimator和ObjectAnimator的高级用法</a></li>
<li><a href="http://item.jd.com/1710650057.html" target="_blank" rel="noopener">Android开发艺术探索 —— 第七章 Android动画深入分析</a></li>
</ul>
<h2 id="基础入门"><a href="#基础入门" class="headerlink" title="基础入门"></a>基础入门</h2><p>　　属性动画有两个常用的类：<code>ValueAnimator</code>和<code>ObjectAnimator</code>，接下来依次介绍它们。</p>
<h3 id="ValueAnimator"><a href="#ValueAnimator" class="headerlink" title="ValueAnimator"></a>ValueAnimator</h3><p><br>　　范例1：<code>ValueAnimator</code>的用法很简单，比如说想要将一个值从<code>0</code>平滑过渡到<code>1</code>，时长<code>300</code>毫秒，就可以这样写：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用ofFloat()方法来创建一个ValueAnimator对象，其中参数0和1就表示将值从0平滑过渡到1。</span></span><br><span class="line">ValueAnimator anim = ValueAnimator.ofFloat(<span class="number">0f</span>, <span class="number">1f</span>);</span><br><span class="line"><span class="comment">// setDuration()方法来设置动画运行的时长。</span></span><br><span class="line">anim.setDuration(<span class="number">300</span>);</span><br><span class="line"><span class="comment">// 启动动画。</span></span><br><span class="line">anim.start();</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  本范例使用的是android.animation.ValueAnimator类。
-  我们只需要将初始值和结束值提供给ValueAnimator，并且告诉它动画所需运行的时长，那么ValueAnimator就会自动帮我们完成从初始值平滑地过渡到结束值这样的效果。
</code></pre><p><br>　　范例2：运行上面的代码时无法看到任何效果，需要借助监听器才能知道这个动画是否已经真正运行了，如下所示：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ValueAnimator anim = ValueAnimator.ofFloat(<span class="number">0f</span>, <span class="number">1f</span>);</span><br><span class="line">anim.setDuration(<span class="number">300</span>);</span><br><span class="line">anim.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator valueAnimator)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"cuurent value is "</span> + valueAnimator.getAnimatedValue());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">anim.start();</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  在动画执行的过程中系统会不断地回调onAnimationUpdate()方法，我们只需要在回调方法当中将当前的值取出并打印出来。
-  回调onAnimationUpdate()方法的时间间隔是ValueAnimator类根据你设置的初始值、结束值、动画时间三个参数来计算出来的，不需要我们设置，它会尽可能的让动画平滑的播放出来（即在使用最少的回调次数的基础上，保证动画流畅）。
</code></pre><p><br>　　范例3：<code>ofFloat()</code>方法可以传入任意多个参数。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在3秒内从0过渡到5，再过渡到3，再过渡到10。</span></span><br><span class="line">ValueAnimator anim = ValueAnimator.ofFloat(<span class="number">0f</span>, <span class="number">5f</span>, <span class="number">3f</span>, <span class="number">10f</span>);</span><br><span class="line">anim.setDuration(<span class="number">3000</span>);</span><br><span class="line">anim.start();</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  如果只是希望将一个整数值从0平滑地过渡到100，那么也很简单，只需要调用ValueAnimator.ofInt(0, 100)就可以了。
-  调用anim.setRepeatCount()设置循环播放的次数，默认为1次，ValueAnimator.INFINITE为无限循环。
-  调用anim.setRepeatMode()设置循环播放的模式：
   -  RESTART（默认），动画播放到结尾时，直接从开头再播放。
   -  REVERSE，动画播放到结尾时，再从结尾再往开头播放。
-  除此之外，我们还可以调用anim.setStartDelay()方法来设置动画延迟播放的时间。
</code></pre><h3 id="ObjectAnimator"><a href="#ObjectAnimator" class="headerlink" title="ObjectAnimator"></a>ObjectAnimator</h3><p>　　<code>ObjectAnimator</code>是<code>ValueAnimator</code>的子类。<br>　　<code>ObjectAnimator</code>除了具有其父类的所有特性之外，还在父类的基础上增加了对对象属性进行动画功能，如动画<code>View</code>的<code>alpha</code>属性的值。</p>
<p><br>　　范例1：修改透明度。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Button btn = (Button) findViewById(R.id.btn);</span><br><span class="line"><span class="comment">// 第一个参数是想动画的对象，第二个参数是该对象的属性。</span></span><br><span class="line">ObjectAnimator animator = ObjectAnimator.ofFloat(btn, <span class="string">"alpha"</span>, <span class="number">1f</span>, <span class="number">0f</span>, <span class="number">1f</span>);</span><br><span class="line">animator.setDuration(<span class="number">5000</span>);</span><br><span class="line">animator.start();</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  本范例用来将Button在5秒内从不透明变换成全透明，再从全透明变换成不透明。
-  把代码改成“ObjectAnimator.ofFloat(btn, &quot;rotation&quot;, 0, 360)”则按钮就会被旋转。
-  把代码改成“ObjectAnimator.ofFloat(btn, &quot;scaleY&quot;, 1f, 3f, 1f)”则按钮就会在垂直方向上进行缩放，然后还原。
-  把代码改成“ObjectAnimator.ofFloat(btn, &quot;rotation&quot;, 0, 360)”则按钮就会被旋转。
-  把代码改成“ObjectAnimator.ofFloat(btn, &quot;translationX&quot;, curTranslationX, -500f)”则按钮就会从curTranslationX移动到-500。
</code></pre><p><br>　　此时也许你会有一个疑问，就是<code>ObjectAnimator</code>的<code>ofFloat()</code>方法的第二个参数到底可以传哪些值呢？</p>
<pre><code>-  答案是，我们可以传入任意的值，系统在执行动画时会通过反射机制调用对象的get和set方法。
   -  比如，若我们给第二个参数传递abc，那么系统就是调用Button的setAbc和getAbc两个方法。
-  只要在get和set方法中执行相应的操作即可。
</code></pre><p>　　相应的，<code>rotation</code>对应的就是<code>setRotation()</code>和<code>getRotation()</code>方法，这两个方法在<code>View</code>类中定义了。</p>
<p><br><strong>引入一个问题</strong><br>　　我们现在有个需求，给<code>Button</code>加一个动画，让这个<code>Button</code>的<code>paddingLeft</code>从当前值增加到<code>500px</code>。按照上面的思路，我们可以这么写代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View button)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 当Button被点击时，我们启动一个属性动画，修改Button的paddingLeft属性的值到500 。</span></span><br><span class="line">        ObjectAnimator.ofInt(button, <span class="string">"paddingLeft"</span>, <span class="number">500</span>).setDuration(<span class="number">5000</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　上述代码运行后发现没效果，这是因为属性动画如果想成功运行，需要两个条件：</p>
<pre><code>-  object必须要提供set方法，如果动画的时候没有传递初始值，那么还要提供get方法，因为系统要去拿属性的初始值。
-  object的set对属性所做的改变必须能够通过某种方法反映出来，比如会带来UI的改变之类的（如果这条不满足，动画就不会有效果）。
</code></pre><p>　　上面范例之所以不成功是因为<code>View</code>类没有<code>setPaddingLeft</code>方法，而只有<code>setPadding()</code>方法，为了实现这个需求，我们可以用一个类来包装原始的<code>Button</code>对象，代码为：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View button)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 将按钮放到一个ViewWrapper中。</span></span><br><span class="line">        ObjectAnimator.ofInt(<span class="keyword">new</span> ViewWrapper(button), <span class="string">"paddingLeft"</span>, <span class="number">500</span>).setDuration(<span class="number">5000</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 一个普通的包装类。</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewWrapper</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> View mTarget;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ViewWrapper</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.mTarget = view;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPaddingLeft</span><span class="params">(<span class="keyword">int</span> paddingLeft)</span> </span>&#123;</span><br><span class="line">            mTarget.setPadding(paddingLeft, mTarget.getPaddingTop(),</span><br><span class="line">                    mTarget.getPaddingRight(), mTarget.getPaddingBottom());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  这样一来程序运行时就可以看到动画效果了。
-  如果你修改完属性后View没有自动更新，那么你可以调用requestlayout()或invalidate()方法手动更新。
</code></pre><p><br><strong>本节参考阅读：</strong></p>
<ul>
<li><a href="http://blog.csdn.net/singwhatiwanna/article/details/17841165" target="_blank" rel="noopener">Android属性动画深入分析：让你成为动画牛人</a></li>
</ul>
<h3 id="组合动画"><a href="#组合动画" class="headerlink" title="组合动画"></a>组合动画</h3><p>　　我们可以通过<code>AnimatorSet</code>类来将多个动画组合到一起播放，这个类提供了一个<code>play()</code>方法，如果我们向这个方法中传入一个<code>Animator</code>对象（<code>ValueAnimator</code>的父类）将会返回一个<code>AnimatorSet.Builder</code>的实例。<br>　　<code>AnimatorSet.Builder</code>中包括以下四个方法：</p>
<pre><code>-  after(Animator anim)    将现有动画插入到传入的动画之后执行
-  after(long delay)       将现有动画延迟指定毫秒后执行
-  before(Animator anim)   将现有动画插入到传入的动画之前执行
-  with(Animator anim)     将现有动画和传入的动画同时执行
</code></pre><p><br>　　比如说我们想要让<code>Button</code>先从屏幕外移动进屏幕，然后开始旋转<code>360</code>度，旋转的同时进行淡入淡出操作，就可以这样写：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Button btn = (Button) findViewById(R.id.btn);</span><br><span class="line">ObjectAnimator moveIn = ObjectAnimator.ofFloat(btn, <span class="string">"translationX"</span>, -<span class="number">500f</span>, <span class="number">0f</span>);</span><br><span class="line">ObjectAnimator rotate = ObjectAnimator.ofFloat(btn, <span class="string">"rotation"</span>, <span class="number">0f</span>, <span class="number">360f</span>);</span><br><span class="line">ObjectAnimator fadeInOut = ObjectAnimator.ofFloat(btn, <span class="string">"alpha"</span>, <span class="number">1f</span>, <span class="number">0f</span>, <span class="number">1f</span>);</span><br><span class="line">AnimatorSet animSet = <span class="keyword">new</span> AnimatorSet();</span><br><span class="line">animSet.play(rotate).with(fadeInOut).after(moveIn);</span><br><span class="line">animSet.setDuration(<span class="number">5000</span>);</span><br><span class="line">animSet.start();</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  除了上面说的4个方法外，AnimatorSet类也提供了不少方法，比如playTogether、playSequentially等。
</code></pre><h3 id="Animator监听器"><a href="#Animator监听器" class="headerlink" title="Animator监听器"></a>Animator监听器</h3><p>　　在<code>Animator</code>类当中提供了一个<code>addListener()</code>方法，这个方法接收一个<code>AnimatorListener</code>用于监听动画的各种事件了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ValueAnimator anim = ValueAnimator.ofInt(<span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">anim.setDuration(<span class="number">1000</span>);</span><br><span class="line"><span class="comment">// 动画播放的过程中，会回调此接口中的方法。</span></span><br><span class="line">anim.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator valueAnimator)</span> </span>&#123;</span><br><span class="line">        System.out.println(valueAnimator.getAnimatedValue());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 动画播放的状态改变时，会回调此接口中的方法。</span></span><br><span class="line">anim.addListener(<span class="keyword">new</span> Animator.AnimatorListener() &#123;</span><br><span class="line">    <span class="comment">// 动画开始的时候调用</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationStart</span><span class="params">(Animator animation)</span> </span>&#123; &#125;</span><br><span class="line">    <span class="comment">// 动画重复执行的时候调用</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationRepeat</span><span class="params">(Animator animation)</span> </span>&#123; &#125;</span><br><span class="line">    <span class="comment">// 动画结束的时候调用</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationEnd</span><span class="params">(Animator animation)</span> </span>&#123; &#125;</span><br><span class="line">    <span class="comment">// 动画被取消的时候调用</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationCancel</span><span class="params">(Animator animation)</span> </span>&#123; &#125;</span><br><span class="line">&#125;);</span><br><span class="line">anim.start();</span><br></pre></td></tr></table></figure>
<p><br>　　为了方便使用，可以继承<code>AnimatorListenerAdapter</code>类，这样我们就可以只重写自己需要的方法了，如下所示：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">anim.addListener(<span class="keyword">new</span> AnimatorListenerAdapter() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationEnd</span><span class="params">(Animator animation)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="使用XML编写动画"><a href="#使用XML编写动画" class="headerlink" title="使用XML编写动画"></a>使用XML编写动画</h3><p>　　通过<code>XML</code>来编写动画可能会比通过代码来编写动画要慢一些，但是在重用方面将会变得非常轻松。<br><br>　　如果想要使用<code>XML</code>来编写动画，首先要在<code>res</code>目录下面新建一个<code>animator</code>文件夹，所有属性动画的<code>XML</code>文件都应该存放在这个文件夹当中。然后在<code>XML</code>文件中我们一共可以使用如下三种标签：</p>
<pre><code>-  &lt;animator&gt;        对应代码中的 ValueAnimator
-  &lt;objectAnimator&gt;  对应代码中的 ObjectAnimator
-  &lt;set&gt;             对应代码中的 AnimatorSet
</code></pre><p><br>　　比如说我们想要实现一个从<code>0</code>到<code>100</code>平滑过渡的动画，在<code>XML</code>当中就可以这样写：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">animator</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:valueFrom</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:valueTo</span>=<span class="string">"100"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:valueType</span>=<span class="string">"intType"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>　　而如果我们想将一个视图的<code>alpha</code>属性从<code>1</code>变成<code>0</code>，就可以这样写：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">objectAnimator</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:valueFrom</span>=<span class="string">"1"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:valueTo</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:valueType</span>=<span class="string">"floatType"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:propertyName</span>=<span class="string">"alpha"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>　　其实<code>XML</code>编写动画在可读性方面还是挺高的，上面的内容不用解释也都能看得懂。</p>
<p><br>　　另外，我们也可以使用<code>XML</code>来完成复杂的组合动画操作，比如将一个视图先从屏幕外移动进屏幕，然后开始旋转<code>360</code>度，旋转的同时进行淡入淡出操作，就可以这样写：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:ordering</span>=<span class="string">"sequentially"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">objectAnimator</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"2000"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:propertyName</span>=<span class="string">"translationX"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:valueFrom</span>=<span class="string">"-500"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:valueTo</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:valueType</span>=<span class="string">"floatType"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">objectAnimator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span> <span class="attr">android:ordering</span>=<span class="string">"together"</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">objectAnimator</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:duration</span>=<span class="string">"3000"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:propertyName</span>=<span class="string">"rotation"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:valueFrom</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:valueTo</span>=<span class="string">"360"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:valueType</span>=<span class="string">"floatType"</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">objectAnimator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span> <span class="attr">android:ordering</span>=<span class="string">"sequentially"</span> &gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">objectAnimator</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:duration</span>=<span class="string">"1500"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:propertyName</span>=<span class="string">"alpha"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:valueFrom</span>=<span class="string">"1"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:valueTo</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:valueType</span>=<span class="string">"floatType"</span> &gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">objectAnimator</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">objectAnimator</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:duration</span>=<span class="string">"1500"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:propertyName</span>=<span class="string">"alpha"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:valueFrom</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:valueTo</span>=<span class="string">"1"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:valueType</span>=<span class="string">"floatType"</span> &gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">objectAnimator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  这段XML实现的效果和刚才代码实现的效果是一模一样的，每个参数的含义都非常清楚，相信一看就懂。
-  另外，objectAnimator和animator标签除了上面的属性外，都还包含如下三个属性：
   -  startOffset、repeatCount、repeatMode
-  实际上，objectAnimator标签只是比animator标签多了一个propertyName属性。
</code></pre><p><br>　　<code>XML</code>文件是编写好了，可以使用如下代码进行播放：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加载动画。</span></span><br><span class="line">Animator animator = AnimatorInflater.loadAnimator(context, R.animator.anim_file);</span><br><span class="line"><span class="comment">// 设置要播放此动画的View。</span></span><br><span class="line">animator.setTarget(view);</span><br><span class="line"><span class="comment">// 开始播放。</span></span><br><span class="line">animator.start();</span><br></pre></td></tr></table></figure></p>
<p><br>　　提示：如果你使用的是<code>NineOldAndroids</code>动画库，那么在<code>Android3.0</code>之前的设备上，最好通过代码来实现属性动画。</p>
<h2 id="高级用法"><a href="#高级用法" class="headerlink" title="高级用法"></a>高级用法</h2><h3 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h3><p>　　为了能深入理解属性动画的两个重要的概念：<code>TimeInterpolator</code>和<code>TypeEvaluator</code>，我们得需要先知道属性动画的工作流程。</p>
<p>　　假设我们现在需要动画<code>Button</code>的<code>translationX</code>属性，让它在<code>4</code>秒内从<code>0</code>变为<code>100</code>。<br>　　当我们调用它的<code>start</code>方法启动动画时，系统会执行如下过程：</p>
<pre><code>-  第一，会开启一个定时器，这个定时器每隔一段时间就会出发一次绘制动画的任务。
-  第二，当绘制任务被触发时，会调用当前ObjectAnimator的TimeInterpolator字段来计算出一个跟时间有关系的比例值。
-  第三，把计算出来的比例值交给当前ObjectAnimator的TypeEvaluator字段，由其来计算出动画当前的播放位置。
-  第四，会通过反射的方式把第三步计算出的播放位置传递给目标方法，执行更新操作。
</code></pre><p><br>　　此时你可能会有疑问，为什么要用到<code>TimeInterpolator</code>类呢？</p>
<pre><code>-  按照我们熟悉的逻辑，动画的播放进度是需要和时间相关的，也就是说当动画播放到1秒的时候，translationX的值应该是25，执行到2秒的时候值应该是50。这个逻辑其实是一个线性的变化，即动画的播放进度随着时间的推移，均匀的改变。
-  但是在很多时候我们有更高的要求，比如希望动画以加速度或者减速度的形式播放，又或者希望动画在开始的部分加速播放，在结束的部分减速播放，这时候就需要用到TimeInterpolator类了。
-  当绘制任务被触发时，系统会调用TimeInterpolator的getInterpolation方法，并传递过去一个数值input，这个数值表示动画当前已经播放的比率，TimeInterpolator会依据这个比率计算出最终的比率。
-  最后，系统会把getInterpolation方法返回的结果当作动画最终的播放比例，进行后续的计算。
</code></pre><p><br>　　事实上，<code>TimeInterpolator</code>类有很多现有的子类，比如<code>LinearInterpolator</code>类：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinearInterpolator</span> <span class="keyword">extends</span> <span class="title">BaseInterpolator</span> <span class="keyword">implements</span> <span class="title">NativeInterpolatorFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LinearInterpolator</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LinearInterpolator</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getInterpolation</span><span class="params">(<span class="keyword">float</span> input)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> input;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  由于系统默认使用的就是线性变化，所以LinearInterpolator的getInterpolation方法直接将参数给返回了。
</code></pre><p><br>　　再比如，<code>ValueAnimator</code>类默认使用的是<code>AccelerateDecelerateInterpolator</code>，它的源码为：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccelerateDecelerateInterpolator</span> <span class="keyword">extends</span> <span class="title">BaseInterpolator</span></span></span><br><span class="line"><span class="class">        <span class="keyword">implements</span> <span class="title">NativeInterpolatorFactory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AccelerateDecelerateInterpolator</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AccelerateDecelerateInterpolator</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getInterpolation</span><span class="params">(<span class="keyword">float</span> input)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">float</span>)(Math.cos((input + <span class="number">1</span>) * Math.PI) / <span class="number">2.0f</span>) + <span class="number">0.5f</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  这个加速器的作用前面也已经说了，就是在动画开始的时候加速，在动画结束的时候减速。
</code></pre><p><br>　　下图是笔者从网上找的一张图，简单的介绍了各个系统内置插值器的特点，但笔者没去验证它的真伪：</p>
<center><br><img src="/img/android/android_d03_01.png" alt=""><br></center>

<p><br>　　此时你可能还会有疑问，那<code>TypeEvaluator</code>类又是干什么的呢？</p>
<pre><code>-  我们已经知道，通过TimeInterpolator类计算出来的其实是动画已经播放的比率。也就是说，如果是线性插值器的话，当动画播放到第2秒时，比率的值就是0.5。
-  但是比率毕竟是比率，我们还需要依据这个比率来计算出动画真正的位置。
-  只有知道了的动画的当前位置，我们才能修改translationX的值，这时候就用到TypeEvaluator类了。
</code></pre><p><br>　　事实上，<code>TypeEvaluator</code>类也有两个现成的子类，比如<code>IntEvaluator</code>类：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IntEvaluator</span> <span class="keyword">implements</span> <span class="title">TypeEvaluator</span>&lt;<span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">evaluate</span><span class="params">(<span class="keyword">float</span> fraction, Integer startValue, Integer endValue)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> startInt = startValue;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)(startInt + fraction * (endValue - startInt));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  在上面的代码中，如果把fraction替换成0.5的话，就可以很容易的计算出结果是什么。
-  大声的告诉我，结果是什么？ 没错！就是它！
</code></pre><p>　　<code>TypeEvaluator</code>类的另一个子类<code>FloatEvaluator</code>的代码和<code>IntEvaluator</code>相仿，笔者就不再冗述了。</p>
<h3 id="源码阅读"><a href="#源码阅读" class="headerlink" title="源码阅读"></a>源码阅读</h3><p>　　上面简单的介绍了动画播放过程，接下来再从源码的角度来看一下。比如现在需要执行如下代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ObjectAnimator moveIn = ObjectAnimator.ofFloat(button, <span class="string">"translationX"</span>, -<span class="number">500</span>, <span class="number">500</span>);</span><br><span class="line">moveIn.setDuration(<span class="number">1000</span>);</span><br><span class="line">moveIn.start();</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  注意：View类定义的setTranslationX方法接收的是float类型的参数，所以调用ObjectAnimator.ofInt方法是无效的。
</code></pre><p><br>　　首先来看看<code>ObjectAnimator</code>类的<code>ofFloat</code>方法里面执行了哪些操作：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ObjectAnimator <span class="title">ofFloat</span><span class="params">(Object target, String propertyName, <span class="keyword">float</span>... values)</span> </span>&#123;</span><br><span class="line">    ObjectAnimator anim = <span class="keyword">new</span> ObjectAnimator(target, propertyName);</span><br><span class="line">    anim.setFloatValues(values);</span><br><span class="line">    <span class="keyword">return</span> anim;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFloatValues</span><span class="params">(<span class="keyword">float</span>... values)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (mValues == <span class="keyword">null</span> || mValues.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mProperty != <span class="keyword">null</span>) &#123;</span><br><span class="line">            setValues(PropertyValuesHolder.ofFloat(mProperty, values));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 由于是首次调用，所以会执行这个分支，即创建一个PropertyValuesHolder对象。</span></span><br><span class="line">            setValues(PropertyValuesHolder.ofFloat(mPropertyName, values));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.setFloatValues(values);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setValues</span><span class="params">(PropertyValuesHolder... values)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 此处省略若干代码...</span></span><br><span class="line">    mValues = values;</span><br><span class="line">    <span class="comment">// 此处省略若干代码...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  在上面的代码中，只需要记住两个地方即可，因为后面会用到它们：
   -  第一，ObjectAnimator类有一个mValues属性后面会用到。
   -  第二，mValues属性是PropertyValuesHolder[]类型的。
</code></pre><p><br>　　接着来看看<code>ObjectAnimator</code>类的<code>start</code>方法，它是动画执行时最先调用的方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 此处省略若干代码...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">super</span>.start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  为了减少篇幅，就不把start方法里的代码贴出来，因为贴出来并没有什么屌用。
-  省略掉的代码做的事情很简单，首先会判断如果正在播放的动画、等待的动画和延迟的动画中有和当前动画相同的动画，那么就把相同的动画给取消掉。
-  最后调用父类的start方法。
</code></pre><p><br>　　由于<code>ObjectAnimator</code>类继承了<code>ValueAnimator</code>类，所以接着看一下<code>ValueAnimator</code>类的<code>start</code>方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(<span class="keyword">boolean</span> playBackwards)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (Looper.myLooper() == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> AndroidRuntimeException(<span class="string">"Animators may only be run on Looper threads"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 此处省略若干代码...</span></span><br><span class="line"></span><br><span class="line">    AnimationHandler animationHandler = getOrCreateAnimationHandler();</span><br><span class="line">    animationHandler.mPendingAnimations.add(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">if</span> (mStartDelay == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// This sets the initial value of the animation, prior to actually starting it running</span></span><br><span class="line">        <span class="keyword">if</span> (prevPlayingState != SEEKED) &#123;</span><br><span class="line">            setCurrentPlayTime(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        mPlayingState = STOPPED;</span><br><span class="line">        mRunning = <span class="keyword">true</span>;</span><br><span class="line">        notifyStartListeners();</span><br><span class="line">    &#125;</span><br><span class="line">    animationHandler.start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  从上面的代码可以看出如下两点：
   -  属性动画需要运行在有Looper的线程中。
   -  动画被放到了一个AnimationHandler对象中，并调用AnimationHandler对象的start方法执行播放操作。
</code></pre><p><br>　　接着继续跟进<code>AnimationHandler</code>类的<code>start</code>方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    scheduleAnimation();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">scheduleAnimation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!mAnimationScheduled) &#123;</span><br><span class="line">        mChoreographer.postCallback(Choreographer.CALLBACK_ANIMATION, mAnimate, <span class="keyword">null</span>);</span><br><span class="line">        mAnimationScheduled = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">final</span> Runnable mAnimate = <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mAnimationScheduled = <span class="keyword">false</span>;</span><br><span class="line">        doAnimationFrame(mChoreographer.getFrameTime());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">doAnimationFrame</span><span class="params">(<span class="keyword">long</span> frameTime)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 此处省略若干代码...</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numAnims; ++i) &#123;</span><br><span class="line">        ValueAnimator anim = mTmpAnimations.get(i);</span><br><span class="line">        <span class="comment">// 调用ValueAnimator的doAnimationFrame方法进行绘制</span></span><br><span class="line">        <span class="keyword">if</span> (mAnimations.contains(anim) &amp;&amp; anim.doAnimationFrame(frameTime)) &#123;</span><br><span class="line">            mEndingAnims.add(anim);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 此处省略若干代码...</span></span><br><span class="line">    <span class="keyword">if</span> (!mAnimations.isEmpty() || !mDelayedAnims.isEmpty()) &#123;</span><br><span class="line">        <span class="comment">// 检测是否还有未绘制的帧，如果有则再次安排下一帧的事件到Choreographer中。</span></span><br><span class="line">        scheduleAnimation();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  在start方法内部会转调用scheduleAnimation方法，scheduleAnimation方法会将mAnimate安排到Choreographer中。
-  Choreographer内部的代码我们不再继续深入了，因为它最终会回调mAnimate的run方法。
</code></pre><p><br>　　在<code>ValueAnimator</code>的<code>doAnimationFrame</code>方法中又会依次调用<code>animationFrame</code>和<code>animateValue</code>方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">animateValue</span><span class="params">(<span class="keyword">float</span> fraction)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 调用当前动画的插值器，计算出动画播放的比率fraction。</span></span><br><span class="line">    fraction = mInterpolator.getInterpolation(fraction);</span><br><span class="line">    mCurrentFraction = fraction;</span><br><span class="line">    <span class="keyword">int</span> numValues = mValues.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numValues; ++i) &#123;</span><br><span class="line">        <span class="comment">// 将播放比率传递过去，计算出动画当前的播放位置。</span></span><br><span class="line">        mValues[i].calculateValue(fraction);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (mUpdateListeners != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> numListeners = mUpdateListeners.size();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numListeners; ++i) &#123;</span><br><span class="line">            mUpdateListeners.get(i).onAnimationUpdate(<span class="keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code>语句解释：
-  前面已经说了，mValues是PropertyValuesHolder[]类型的，而calculateValue方法是属于PropertyValuesHolder类的。
</code></pre><p><br>　　接着查看<code>PropertyValuesHolder</code>类<code>calculateValue</code>方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calculateValue</span><span class="params">(<span class="keyword">float</span> fraction)</span> </span>&#123;</span><br><span class="line">    Object value = mKeyframes.getValue(fraction);</span><br><span class="line">    mAnimatedValue = mConverter == <span class="keyword">null</span> ? value : mConverter.convert(value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  前面也已经说了，当调用ObjectAnimator.ofFloat时会创建一个FloatPropertyValuesHolder对象。
-  但是当时没有进一步查看FloatPropertyValuesHolder里的代码。
-  现在回过头去就可以发现mKeyframes初始化代码为：KeyframeSet.ofFloat(values)。
</code></pre><p><br>　　因此我们接下来要去查看<code>KeyframeSet</code>类的<code>getValue</code>方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">getValue</span><span class="params">(<span class="keyword">float</span> fraction)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 此处省略若干代码...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> mEvaluator.evaluate(fraction, mFirstKeyframe.getValue(),</span><br><span class="line">            mLastKeyframe.getValue());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 此处省略若干代码...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  从上面的代码片段可以看出，在此方法中会调用动画的TypeEvaluator来计算出动画的实际位置，并将位置返回。
</code></pre><p><br>　　至此，我们就完成了一开始说的，系统播放动画时所要执行的四步操作中的前三步的源码解读了，还剩最后一步：</p>
<pre><code>-  第四，会通过反射的方式把第三步计算出的播放位置传递给目标方法，执行更新操作。
</code></pre><p>　　但是目前来看，线索好像断了，我们无从追踪了。</p>
<p>　　不过不要慌！这里有个坑，那就是<code>ObjectAnimator</code>类重写了<code>animateValue</code>方法，我们来看一下重写后的代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">animateValue</span><span class="params">(<span class="keyword">float</span> fraction)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 此处省略若干代码...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用父类的方法计算当前动画播放的位置。</span></span><br><span class="line">    <span class="keyword">super</span>.animateValue(fraction);</span><br><span class="line">    <span class="keyword">int</span> numValues = mValues.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numValues; ++i) &#123;</span><br><span class="line">        <span class="comment">// 使用计算出来的播放位置，去绘制。</span></span><br><span class="line">        mValues[i].setAnimatedValue(target);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  正如我们看到的那样，在调用父类的animateValue方法计算播放位置之后，它还有后续操作。
-  由于知道了mValues里存放的是FloatPropertyValuesHolder类型的，所以直接去查看它的setAnimatedValue方法即可。
</code></pre><p><br>　　阅读<code>setAnimatedValue</code>方法的源码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setAnimatedValue</span><span class="params">(Object target)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 此处省略若干代码...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mSetter != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            mTmpValueArray[<span class="number">0</span>] = mFloatAnimatedValue;</span><br><span class="line">            mSetter.invoke(target, mTmpValueArray);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">            Log.e(<span class="string">"PropertyValuesHolder"</span>, e.toString());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            Log.e(<span class="string">"PropertyValuesHolder"</span>, e.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  到这里就算圆满了，我们看到了反射相关的代码了。
</code></pre><h3 id="动画对象"><a href="#动画对象" class="headerlink" title="动画对象"></a>动画对象</h3><p>　　通过前面的学习，我们已经可以实现如下两种属性动画了：</p>
<pre><code>-  动画一个int或float值。
-  动画一个对象的某个属性值。
</code></pre><p>　　本节就来介绍一下，如何动画一个对象。</p>
<p><br>　　首先来定义一个<code>Point</code>类，如下所示：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> x;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> y;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Point</span><span class="params">(<span class="keyword">float</span> x, <span class="keyword">float</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.x = x;</span><br><span class="line">        <span class="keyword">this</span>.y = y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getX</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getY</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  Point类非常简单，只有x和y两个变量用于记录坐标的位置，并提供了构造方法来设置坐标。
</code></pre><p><br>　　接下来定义<code>PointEvaluator</code>，如下所示：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PointEvaluator</span> <span class="keyword">implements</span> <span class="title">TypeEvaluator</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">evaluate</span><span class="params">(<span class="keyword">float</span> fraction, Object startValue, Object endValue)</span> </span>&#123;</span><br><span class="line">        Point startPoint = (Point) startValue;</span><br><span class="line">        Point endPoint = (Point) endValue;</span><br><span class="line">        <span class="keyword">float</span> x = startPoint.getX() + fraction * (endPoint.getX() - startPoint.getX());</span><br><span class="line">        <span class="keyword">float</span> y = startPoint.getY() + fraction * (endPoint.getY() - startPoint.getY());</span><br><span class="line">        Point point = <span class="keyword">new</span> Point(x, y);</span><br><span class="line">        <span class="keyword">return</span> point;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  这样我们就将PointEvaluator编写完成了，接下来我们就可以非常轻松地对Point对象进行动画操作了。
</code></pre><p><br>　　比如说我们有两个<code>Point</code>对象，现在需要将<code>Point1</code>通过动画平滑过度到<code>Point2</code>，就可以这样写：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Point point1 = <span class="keyword">new</span> Point(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">Point point2 = <span class="keyword">new</span> Point(<span class="number">300</span>, <span class="number">300</span>);</span><br><span class="line">ValueAnimator anim = ValueAnimator.ofObject(<span class="keyword">new</span> PointEvaluator(), point1, point2);</span><br><span class="line">anim.setDuration(<span class="number">5000</span>);</span><br><span class="line">anim.start();</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  ValueAnimator.ofObject专门用来动画一个对象。
</code></pre><p><br>　　接下来新建一个<code>MyAnimView</code>，在其内部播放动画，代码如下所示：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAnimView</span> <span class="keyword">extends</span> <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> RADIUS = <span class="number">50f</span>;</span><br><span class="line">    <span class="keyword">private</span> Point currentPoint;</span><br><span class="line">    <span class="keyword">private</span> Paint mPaint;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyAnimView</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">        mPaint = <span class="keyword">new</span> Paint(Paint.ANTI_ALIAS_FLAG);</span><br><span class="line">        mPaint.setColor(Color.BLUE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (currentPoint == <span class="keyword">null</span>) &#123;</span><br><span class="line">            startAnimation();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            canvas.drawCircle(currentPoint.getX(), currentPoint.getY(), RADIUS, mPaint);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startAnimation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Point startPoint = <span class="keyword">new</span> Point(RADIUS, RADIUS);</span><br><span class="line">        Point endPoint = <span class="keyword">new</span> Point(getWidth() - RADIUS, getHeight() - RADIUS);</span><br><span class="line">        ValueAnimator anim = ValueAnimator.ofObject(<span class="keyword">new</span> PointEvaluator(), startPoint, endPoint);</span><br><span class="line">        anim.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator animation)</span> </span>&#123;</span><br><span class="line">                currentPoint = (Point) animation.getAnimatedValue();</span><br><span class="line">                invalidate();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        anim.setDuration(<span class="number">5000</span>);</span><br><span class="line">        anim.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  自定义控件相关的知识在后面章节中会详细介绍。
</code></pre><p><br>　　然后我们只需要在布局文件当中引入这个自定义控件：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.example.cutler.androidtest.MyAnimView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>　　最后运行一下程序，效果如下图所示：</p>
<center><br><img src="http://img.blog.csdn.net/20150504225258841" alt=""><br></center>

<p><br>　　我们可以再扩展一下，让圆形在移动的同时变色，代码如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startAnimation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 移动动画</span></span><br><span class="line">    Point startPoint = <span class="keyword">new</span> Point(RADIUS, RADIUS);</span><br><span class="line">    Point endPoint = <span class="keyword">new</span> Point(getWidth() - RADIUS, getHeight() - RADIUS);</span><br><span class="line">    ValueAnimator moveAnim = ValueAnimator.ofObject(<span class="keyword">new</span> PointEvaluator(), startPoint, endPoint);</span><br><span class="line">    moveAnim.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator animation)</span> </span>&#123;</span><br><span class="line">            currentPoint = (Point) animation.getAnimatedValue();</span><br><span class="line">            invalidate();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 颜色变化的动画。 8位数字表示ARGB，每个颜色占2位。</span></span><br><span class="line">    ValueAnimator colorAnim = ValueAnimator.ofInt(<span class="number">0xFF0000FF</span>, <span class="number">0xFFFF0000</span>);</span><br><span class="line">    colorAnim.setEvaluator(<span class="keyword">new</span> ArgbEvaluator());</span><br><span class="line">    colorAnim.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator animation)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// 获取动画的当前值，并将它转为16进制的形式。</span></span><br><span class="line">            String color = Integer.toHexString((Integer) animation.getAnimatedValue());</span><br><span class="line">            <span class="comment">// 设置画笔的颜色。</span></span><br><span class="line">            mPaint.setColor(Color.parseColor(<span class="string">"#"</span> + color));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 同时播放这两个动画</span></span><br><span class="line">    AnimatorSet animSet = <span class="keyword">new</span> AnimatorSet();</span><br><span class="line">    animSet.play(colorAnim).with(moveAnim);</span><br><span class="line">    animSet.setDuration(<span class="number">5000</span>);</span><br><span class="line">    animSet.start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  动画的效果是什么，运行代码就知道了。
</code></pre><h1 id="第四节-NineOldAndroids"><a href="#第四节-NineOldAndroids" class="headerlink" title="第四节 NineOldAndroids"></a>第四节 NineOldAndroids</h1><p>　　前面说了，属性动画是在<code>Android3.0</code>中推出的，在<code>Android3.0</code>之前没法使用它。<br>　　但是万事总有一线生机，现在有一个名为<code>NineOldAndroids</code>动画库，可以让低于<code>Android3.0(API Level 11)</code>的项目使用上属性动画。它的作者是非常牛逼的<code>JakeWharton</code>，好几个著名的开源库都是他的作品。<br>　　项目地址：<a href="http://nineoldandroids.com/" target="_blank" rel="noopener">http://nineoldandroids.com/</a> ，<code>JakeWharton</code>的主页为：<a href="https://github.com/JakeWharton" target="_blank" rel="noopener">https://github.com/JakeWharton</a> 。</p>
<p>　　<code>NineOldAndroids</code>的原理很简单，判断当前设备的<code>API Level</code>版本，如果大于等于<code>11</code>，那么就调用<code>官方的API</code>，否则就调用自己实现动画效果。在<code>API</code>的名称等方面，它与官方的属性动画基本一致（如<code>ObjectAnimator</code>、<code>ValueAnimator</code>等），这意味着你只需要修改一下包名就可以在官方和<code>NineOldAndroids</code>之间切换。<br>　　比如说想要将一个值从<code>0</code>平滑过渡到<code>1</code>，时长<code>300</code>毫秒，写法与官方<code>API</code>完全一致：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ValueAnimator anim = ValueAnimator.ofFloat(<span class="number">0f</span>, <span class="number">1f</span>);</span><br><span class="line">anim.setDuration(<span class="number">300</span>);</span><br><span class="line">anim.start();</span><br></pre></td></tr></table></figure></p>
<pre><code>语句解释：
-  值得注意的，本范例使用的是com.nineoldandroids.animation.ValueAnimator类。
</code></pre><p><br>　　遗憾的是，经过笔者测试验证，当<code>NineOldAndroids</code>动画库运行在<code>Android3.0</code>之前（<code>Android3.0</code>及之后会调用系统的API所以不会）的平台时，仍然存在视图动画的缺点（视图的位置不会真正发生改变），<code>Jake Wharton</code>本人也对此做出了回应：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Yes, this is a platform limitation. </span><br><span class="line">You need to physically move the view when the animation ends on pre-Honeycomb.</span><br></pre></td></tr></table></figure></p>
<p>　　<a href="http://stackoverflow.com/questions/13173808/nineoldandroids-not-clickable-view-after-rotation-or-move?rq=1" target="_blank" rel="noopener">点击查看详情</a></p>
<p>　　而且作者本人已经将这个项目给<code>DEPRECATED</code>了，下面是他的解释：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NineOldAndroids is deprecated. No <span class="keyword">new</span> development will be taking place. </span><br><span class="line">Existing versions will (of course) <span class="keyword">continue</span> to function. </span><br><span class="line">New applications should use minSdkVersion=<span class="string">"14"</span> <span class="keyword">or</span> higher which has access to the platform animation APIs.</span><br><span class="line"></span><br><span class="line">Thanks <span class="keyword">for</span> all your support!</span><br></pre></td></tr></table></figure></p>
<p><br>　　这是不是说<code>NineOldAndroids</code>动画库就完全没用了？ 是的，因为就现在来说（2016年10月），你已经可以把App的最低安装版本设置为4.0了。</p>
<p><br><strong>本节参考阅读：</strong></p>
<ul>
<li><a href="http://blog.csdn.net/singwhatiwanna/article/details/17639987" target="_blank" rel="noopener">Android动画进阶—使用开源动画库nineoldandroids</a></li>
<li><a href="http://www.chengxuyuans.com/Android/87451.html" target="_blank" rel="noopener">NineOldAndroids动画兼容库的使用</a></li>
</ul>
<p><br><br></p>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div></div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/images/wechatpay.jpg" alt="乐信圣文 WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
    </div>
  </div>


      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/android-F03/" rel="next" title="进阶篇　第三章 消息机制与线程池">
                <i class="fa fa-chevron-left"></i> 进阶篇　第三章 消息机制与线程池
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/cutler-04/" rel="prev" title="第四章 一年又一年，此人非彼人">
                第四章 一年又一年，此人非彼人 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <div class="ds-share flat" data-thread-key="android-D03/"
     data-title="媒体篇　第三章 动画"
     data-content=""
     data-url="http://yoursite.com/android-D03/">
  <div class="ds-share-inline">
    <ul  class="ds-share-icons-16">

      <li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
      <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
      <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
      <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
      <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>

    </ul>
    <div class="ds-share-icons-more">
    </div>
  </div>
</div>
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="android-D03/"
           data-title="媒体篇　第三章 动画" data-url="http://yoursite.com/android-D03/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="乐信圣文" />
          <p class="site-author-name" itemprop="name">乐信圣文</p>
          <p class="site-description motion-element" itemprop="description">集大家之成，悟小家之道。</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">51</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="http://www.gov.cn/" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://weishu.me/" title="weishu" target="_blank">weishu</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://ryanhoo.github.io/" title="ryanhoo" target="_blank">ryanhoo</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#第一节-视图动画"><span class="nav-number">1.</span> <span class="nav-text">第一节 视图动画</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#第二节-帧动画"><span class="nav-number">2.</span> <span class="nav-text">第二节 帧动画</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#第三节-属性动画"><span class="nav-number">3.</span> <span class="nav-text">第三节 属性动画</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#基础入门"><span class="nav-number">3.1.</span> <span class="nav-text">基础入门</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ValueAnimator"><span class="nav-number">3.1.1.</span> <span class="nav-text">ValueAnimator</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ObjectAnimator"><span class="nav-number">3.1.2.</span> <span class="nav-text">ObjectAnimator</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#组合动画"><span class="nav-number">3.1.3.</span> <span class="nav-text">组合动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Animator监听器"><span class="nav-number">3.1.4.</span> <span class="nav-text">Animator监听器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用XML编写动画"><span class="nav-number">3.1.5.</span> <span class="nav-text">使用XML编写动画</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#高级用法"><span class="nav-number">3.2.</span> <span class="nav-text">高级用法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#工作原理"><span class="nav-number">3.2.1.</span> <span class="nav-text">工作原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#源码阅读"><span class="nav-number">3.2.2.</span> <span class="nav-text">源码阅读</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#动画对象"><span class="nav-number">3.2.3.</span> <span class="nav-text">动画对象</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#第四节-NineOldAndroids"><span class="nav-number">4.</span> <span class="nav-text">第四节 NineOldAndroids</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2014 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">乐信圣文</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"cutler"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  
  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("sGcgYofeKOFi2l1XvGrm0PcP-gzGzoHsz", "Sx0mWxj4pkXYm17zT0UnV5Ca");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
